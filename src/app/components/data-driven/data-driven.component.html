<div class="layer" fxLayout="column">
    <div class="topBar" fxLayout="row">
        <div class="logo" fxLayout="row" fxLayoutAlign="center center">
            <span class="AI">AI</span>
            <span>DataDriven</span>
            <button mat-icon-button [matMenuTriggerFor]="menu" [class.userimage]="user.path">
                <div *ngIf="user.path"
                    [ngStyle]="{'background-image': 'url(' + appConfig.imgBaseUrl + user.path + ')'}"></div>
                <mat-icon *ngIf="!user.path">account_circle</mat-icon>
            </button>
            <mat-menu #menu="matMenu" xPosition="before">
                <button class="nav-category-item" mat-menu-item routerLink="/admin"
                    *ngIf="user?.rights?.includes('USER_MANAGEMENT')">
                    <mat-icon matPrefix>settings</mat-icon>Settings
                </button>
                <mat-divider></mat-divider>
                <button class="nav-category-item" mat-menu-item style="height: auto;">
                    <mat-icon>account_circle</mat-icon>
                    {{user.name}} ({{user.role}}) <br>{{user.email}}
                </button>
                <button class="nav-category-item" mat-menu-item (click)="logout()">
                    <mat-icon>exit_to_app</mat-icon>Logout
                </button>
            </mat-menu>
            <!-- <button mat-icon-button>
                <mat-icon (click)="check()">menu</mat-icon>
            </button> -->
        </div>
    </div>
    <div fxLayout="row" fxFlex>
        <div class="sideBar" fxLayout="column">
            <mat-tree [dataSource]="dataSource" [treeControl]="treeControl" class="menuTree">
                <mat-tree-node *matTreeNodeDef="let node" [class.selected]="node.id && node.id === selectedSource.id"
                    [class.sourceNode]="node.id" (click)="node.route && loadSourceProfile(node)"
                    [class.cleanLog]="node.cleanLogFile">
                    <mat-icon *ngIf="node.icon" fontSet="fa" [fontIcon]="node.icon"></mat-icon>
                    <span>{{node.name}}</span>
                    <!-- <mat-icon *ngIf="node.id" class="rightAlign">edit</mat-icon>
                    <mat-icon *ngIf="node.id">delete</mat-icon> -->
                </mat-tree-node>
                <mat-nested-tree-node *matTreeNodeDef="let node;when: hasChild"
                    [ngClass]="{'expanded':treeControl.isExpanded(node)}">
                    <div class="mat-tree-node" matTreeNodeToggle (click)="node.route && loadSourceProfile(node)">
                        <mat-icon *ngIf="node.icon" fontSet="fa" [fontIcon]="node.icon"></mat-icon>
                        <span>{{node.name}}</span>
                        <mat-icon class="rightAlign">
                            {{treeControl.isExpanded(node) ? 'arrow_drop_down' : 'arrow_right'}}
                        </mat-icon>
                    </div>
                    <div class="childGroup" [class.invisible]="!treeControl.isExpanded(node)" role="group">
                        <ng-container matTreeNodeOutlet></ng-container>
                    </div>
                </mat-nested-tree-node>
            </mat-tree>
        </div>
        <router-outlet></router-outlet>
    </div>
</div>